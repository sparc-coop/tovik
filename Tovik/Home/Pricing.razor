@using Sparc.Blossom.Realtime

@inject ISparcBilling Billing
@inject Microsoft.Extensions.Configuration.IConfiguration Config
@inject SparcEvents Events
@code {
    [Parameter] public EventCallback OnClick { get; set; }
    GetProductResponse? Product;

    protected override async Task OnInitializedAsync()
    {
        Product = await Billing.GetProductAsync(Config["ProductId"]!);
        Events.CurrencyChanged += OnCurrencyChanged;
    }

    private async Task OnCurrencyChanged(SparcCurrency currency)
    {
        Product = await Billing.GetProductAsync(Config["ProductId"]!, currency.Id);
        StateHasChanged();
    }

    async Task OpenPurchaseSidebar()
    {
        await OnClick.InvokeAsync();
    }
}